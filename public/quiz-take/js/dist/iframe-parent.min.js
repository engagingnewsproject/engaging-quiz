function receiveEnpIframeMessage(e){var t,n,a;return a={},!/https?:\/\/(?:dev\b(?!.)|(?:(?:local|dev|test)\.)?engagingnewsproject\.org|engagingnews\.(?:staging\.)?wpengine\.com)/.test(e.origin)&&("string"==typeof e.data&&(data=JSON.parse(e.data),n="0"===data.ab_test_id?"enp-quiz-iframe-"+data.quiz_id:"enp-ab-test-iframe-"+data.ab_test_id,t=document.getElementById(n),"setHeight"===data.action?a.setEnpQuizHeight=setEnpQuizHeight(t,data.height):"scrollToQuiz"===data.action||"quizRestarted"===data.action?a.enpScrollToQuozResponse=enpScrollToQuiz(t):"sendURL"===data.action&&(a.sendEnpParentURLResponse=sendEnpParentURL(),a.saveEnpEmbedSiteResponse=saveEnpEmbedSite(e.origin,data)),a))}function onLoadEnpIframe(){addEnpIframeStyles(),getEnpQuizHeights(),sendEnpParentURL()}function getEnpQuizHeights(){var e,t,n;e=document.getElementsByClassName("enp-quiz-iframe");for(var a=0;a<e.length;++a)t=e[a],n='{"status":"request","action":"sendBodyHeight"}',t.contentWindow.postMessage(n,t.src)}function sendEnpParentURL(){var e,t,n;if(/https?:\/\/(?:dev\/quiz|(?:(?:local|dev|test)\.)?engagingnewsproject\.org)\/enp-quiz\/quiz-preview\/\d+\b/.test(parentURL))return!1;e=document.getElementsByClassName("enp-quiz-iframe");for(var a=0;a<e.length;++a)t=e[a],n='{"status":"request","action":"setShareURL","parentURL":"'+parentURL+'"}',t.contentWindow.postMessage(n,t.src)}function setEnpQuizHeight(e,t){var n=!1;return/([0-9])px/.test(t)&&(e.style.height=t,n=t),n}function enpScrollToQuiz(e){var t=!1,n=e.getBoundingClientRect().top;return-20<n&&n<100?t="noScroll":(scrollBy(0,n-10),t="scrolledTop"),t}function addEnpIframeStyles(){var e=".enp-quiz-iframe { -webkit-transition: all .25s ease-in-out;transition: all .25s ease-in-out; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}function setTimeoutLoadCheck(){alreadyrunflag||onLoadEnpIframe()}function enpSerialize(e){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t=t.slice(0,t.length-1)}function saveEnpEmbedSite(e,t){if(saveEmbedSiteComplete===!0)return!1;var n,a=new XMLHttpRequest;a.open("POST",e+"/wp-content/plugins/enp-quiz/database/class-enp_quiz_save_embed.php"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&200===a.status?(saveEmbedSiteComplete=!0,n=JSON.parse(a.responseText),"success"===n.status?(n.origin=e,n.quiz_id=t.quiz_id,enpHandleEmbedSiteResponse(n)):console.log("XHR request for saveEnpEmbedSite successful but returned response error: "+JSON.stringify(n))):200!==a.status&&console.log("Request failed.  Returned status of "+a.status)},t.embed_site_url=window.location.href,t.embed_site_name=window.location.href,t.save="embed_site",t.action="insert",t.doing_ajax="true",a.send(encodeURI(enpSerialize(t)))}function saveEnpEmbedQuiz(e){if(saveEmbedQuizComplete===!0)return!1;var t=new XMLHttpRequest;return t.open("POST",e.origin+"/wp-content/plugins/enp-quiz/database/class-enp_quiz_save_embed.php"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=saveEnpEmbedQuizReadyState(),embed_quiz={save:"embed_quiz",embed_site_id:e.embed_site_id,quiz_id:e.quiz_id,embed_quiz_url:parentURL,doing_ajax:"true"},t.send(encodeURI(enpSerialize(embed_quiz)))}function saveEnpEmbedQuizReadyState(){if(console.log(xhr.status),xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status){if(saveEmbedQuizComplete=!0,response=JSON.parse(xhr.responseText),"success"===response.status)return console.log("success!"),enpHandleEmbedQuizResponse(response);console.log("XHR request for saveEnpEmbedQuiz successful but returned response error: "+JSON.stringify(response))}else 200!==xhr.status&&console.log("saveEnpEmbedQuizReadyState request failed.  Returned status of "+xhr.status)}function enpHandleEmbedSiteResponse(e){var t=e.embed_site_id;0<parseInt(t)?saveEnpEmbedQuiz(e):console.log("Could't locate a valid Embed Site")}function enpHandleEmbedQuizResponse(e){var t=e.embed_quiz_id;return 0<parseInt(t)?e:void console.log("Could't locate a valid Embed Quiz")}window.addEventListener("message",receiveEnpIframeMessage,!1);var parentURL=window.location.href,alreadyrunflag=0;if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){alreadyrunflag=1,onLoadEnpIframe()},!1);else if(document.all&&!window.opera){document.open(),document.write('<script type="text/javascript" id="contentloadtag" defer="defer" src="javascript:void(0)"></script>'),document.close();var contentloadtag=document.getElementById("contentloadtag");contentloadtag.onreadystatechange=function(){"complete"==this.readyState&&(alreadyrunflag=1,onLoadEnpIframe())}}window.onload=function(){setTimeout(setTimeoutLoadCheck,0)};var saveEmbedSiteComplete=!1,saveEmbedQuizComplete=!1;