jQuery(document).ready(function(e){function n(n,t,i){var a=e.parseJSON(i.responseText);void 0!==a.next_question&&o(a.next_question)}function t(n){e("#question_"+n.question_id).data("questionJSON",n)}function o(n){var o={question_id:n.question_id,question_type:n.question_type,question_title:n.question_title};if(new_questionTemplate=d(o),e(".enp-question__fieldset").after(new_questionTemplate),e("#question_"+n.question_id).addClass("enp-question--on-deck"),t(n),""!==n.question_image){var i={question_image_src:n.question_image_src,question_image_srcset:n.question_image_srcset,question_image_alt:n.question_image_alt};new_questionImageTemplate=m(i),e("#question_"+n.question_id+" .enp-question__question").after(new_questionImageTemplate)}if("mc"===n.question_type){for(var a in n.mc_option)mc_option_id=n.mc_option[a].mc_option_id,mc_option_content=n.mc_option[a].mc_option_content,mcOptionData={mc_option_id:mc_option_id,mc_option_content:mc_option_content},new_mcOption=l(mcOptionData),e("#question_"+n.question_id+" .enp-question__submit").before(new_mcOption);attach_mc_option_data(n)}else"slider"===n.question_type}function i(e,n,t){var o=e["question_responses_"+n+"_percentage"];return o=_.reformat_number(o,100),explanationTemplate=q({question_id:e.question_id,question_explanation:e.question_explanation,question_explanation_title:n,question_explanation_percentage:o}),"function"==typeof t&&t(explanation),explanationTemplate}function a(n,t,o){var i=e.parseJSON(o.responseText);console.log(i)}function s(n,t){var o;return e(".enp-option__input",n).each(function(n,i){return"1"===e(this).data("correct")?(o=e(this),"function"==typeof t&&t(e(this)),!1):void 0}),o}function c(n,t){var o;return e(".enp-option__input",n).each(function(n,i){"0"===e(this).data("correct")&&(o=e(this),"function"==typeof t&&t(e(this)))}),o}function u(e){e.hasClass("enp-option__input--incorrect-clicked")||e.addClass("enp-option__input--slide-hide")}function p(e){e.addClass("enp-option__input--correct")}function r(n){if("mc"===n.question_type)for(var t in n.mc_option)mc_option_id=n.mc_option[t].mc_option_id,mc_option_correct=n.mc_option[t].mc_option_correct,e("#enp-option__"+mc_option_id).data("correct",mc_option_correct)}_.reformat_number=function(e,n,t){return""===n&&(n=1),""===t&&(t=0),e*=n,e=e.toFixed(t)},_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};var l=_.template(e("#mc_option_template").html()),d=_.template(e("#question_template").html()),m=_.template(e("#question_image_template").html()),q=_.template(e("#question_explanation_template").html());e(document).on("click",".enp-option__label",function(n){var t=e(this).prev(".enp-option__input"),o=t.data("correct");e(".enp-question__container").addClass("enp-question__container--explanation").removeClass("enp-question__container--unanswered"),"1"===o?(correct_string="correct",t.addClass("enp-option__input--correct-clicked"),p(t)):(correct_string="incorrect",t.addClass("enp-option__input--incorrect-clicked"),correctInput=s(e(".enp-question__fieldset"),p)),c(e(".enp-question__fieldset"),u);var a=e(this).closest(".enp-question__fieldset").data("questionJSON");console.log(a);var _=i(a,correct_string);e(".enp-question__submit").before(_)}),e(".enp-option__input").change(function(){console.log("changed"),e(".enp-question__submit").trigger("click")}),e(document).on("click",".enp-question__submit",function(t){t.preventDefault(),url=e(".enp-question__form").attr("action"),userAction=e(this).attr("name")+"="+e(this).val(),doing_ajax="doing_ajax=doing_ajax",data=e(".enp-question__form").serialize()+"&"+userAction+"&"+doing_ajax,console.log(data),e.ajax({type:"POST",url:url,data:data,dataType:"json"}).done(n).fail(function(e,n,t){console.log("AJAX failed",e.getAllResponseHeaders(),n,t)}).then(function(e,n,t){console.log("AJAX after finished")}).always(function(){})}),e(document).on("click",".enp-next-step",function(n){n.preventDefault(),url=e(".enp-question__form").attr("action"),userAction=e(this).attr("name")+"="+e(this).val(),doing_ajax="doing_ajax=doing_ajax",data=e(".enp-question__form").serialize()+"&"+userAction+"&"+doing_ajax,e(".enp-question--on-deck").addClass("enp-question--show").removeClass("enp-question--on-deck"),e(this).closest(".enp-question__fieldset").addClass("enp-question--remove"),e(".enp-question__container").removeClass("enp-question__container--explanation").addClass("enp-question__container--unanswered"),e.ajax({type:"POST",url:url,data:data,dataType:"json"}).done(a).fail(function(e,n,t){console.log("AJAX failed",e.getAllResponseHeaders(),n,t)}).then(function(n,t,o){console.log("AJAX after finished"),e(".enp-question__fieldset:first").remove()}).always(function(){})}),t(init_question_json),r(init_question_json)});