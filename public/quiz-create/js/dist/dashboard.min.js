jQuery(document).ready(function(m){function n(e){e.removeClass("enp-dash-item--menu-active"),m(".enp-dash-item__menu-action",e).attr("aria-expanded",!1),m(".enp-dash-item__nav",e).attr("aria-hidden",!0)}function i(e,a,t){if(void 0===t.responseJSON)return o(),u("Something went wrong. Please reload the page and try again.","error"),!1;!function(e){void 0!==e.success&&0<e.success.length&&u(e.success[0],"success");for(var a=0;a<e.error.length;a++)u(e.error[a],"error")}((e=m.parseJSON(t.responseJSON)).message);var n=e.user_action.action,s=e.user_action.element;if("success"===e.status&&"update"===e.action&&"delete"===n){if("quiz"===s)dashItem=m("#enp-dash-item--"+e.quiz_id),!0===function(e){var a=!1;for(var t in e)if("secondary_action"===t)for(var n in e.secondary_action)if("ab_test_deleted"===n)return a=!0;return a}(e.user_action)&&function(e){for(var a=0;a<e.length;a++)if("delete"===e[a].user_action.action&&"success"===e[a].status){var t=e[a].ab_test_id,n=e[a].quiz_id_a,s=e[a].quiz_id_b,i=m("#enp-dash-item--"+t+"a"+n+"b"+s);d(i)}}(e.user_action.secondary_action.ab_test_deleted);else"ab_test"===s&&(dashItem=m("#enp-dash-item--"+e.ab_test_id+"a"+e.quiz_id_a+"b"+e.quiz_id_b));d(dashItem)}}function d(e){e.addClass("enp-dash-item--remove"),setTimeout(function(){e.remove()},300)}function o(){m(".enp-quiz-submit").removeClass("enp-quiz-submit--wait")}function u(e,a){var t=Math.floor(1e3*Math.random()+1);m(".enp-quiz-message-ajax-container").append('<div class="enp-quiz-message enp-quiz-message--ajax enp-quiz-message--'+a+" enp-container enp-message-"+t+'"><p class="enp-message__list enp-message__list--'+a+'">'+e+"</p></div>"),m(".enp-message-"+t).delay(3500).fadeOut(function(){m(".enp-message-"+t).fadeOut()})}m(".enp-search-quizzes__button").addClass("enp-screen-reader-text"),m(document).on("change",".enp-search-quizzes__select",function(){m("#enp-search-quizzes").submit()}),m(".enp-dash-item__nav").each(function(){m(this).addClass("enp-dash-item__nav--collapsible").attr("aria-hidden",!0).before('<button class="enp-dash-item__menu-action" type="button" aria-expanded="false" aria-controls="'+m(this).attr("id")+'"><svg class="enp-dash-item__menu-action__icon enp-dash-item__menu-action__icon--bottom"><use xlink:href="#icon-chevron-down" /></svg><svg class="enp-dash-item__menu-action__icon enp-dash-item__menu-action__icon--top"><use xlink:href="#icon-chevron-down" /></svg></button>')}),m(document).on("click",".enp-dash-item__menu-action",function(){var e,a=m(this).closest(".enp-dash-item");if(a.hasClass("enp-dash-item--menu-active"))n(a);else{var t=m(".enp-dash-item--menu-active");0<t.length&&n(t),(e=a).addClass("enp-dash-item--menu-active"),m(".enp-dash-item__menu-action",e).attr("aria-expanded",!0),m(".enp-dash-item__nav",e).attr("aria-hidden",!1),m(".enp-dash-item__nav__item:eq(0) a",a).focus()}}),m(".enp-dash-item__delete").click(function(e){e.preventDefault();var a,t=m(this).closest(".enp-dash-item"),n=m(this).val();if("delete-quiz"===n?confirmDeleteText="Are you sure you want to delete this quiz? This will also delete any AB Tests you have set-up with this Quiz.":"delete-ab-test"===n?confirmDeleteText="Are you sure you want to delete this AB Test?":alert("Something went wrong. Please send us an email telling us how you reached this error message"),!1===confirm(confirmDeleteText))return!1;if(m(this).hasClass("enp-quiz-submit--wait"))return!1;m(".enp-quiz-submit").addClass("enp-quiz-submit--wait"),(a=t).addClass("enp-dash-item--delete-wait"),a.append('<div class="spinner '+"enp-dash-item__spinner"+'"><div class="bounce bounce1"></div><div class="bounce bounce2"></div><div class="bounce bounce3"></div></div>');var s=function(e,a){var t;"delete-quiz"===a?(r=m(".enp-dash-item__quiz-id",e).val(),c=document.getElementById("enp-delete-quiz-"+r),(l=new FormData(c)).append("enp-quiz-submit","delete-quiz"),l.append("action","save_quiz"),t=l):"delete-ab-test"===a&&(s=m(".enp-dash-item__ab-test-id",n=e).val(),i=m(".enp-dash-item__quiz-id-a",n).val(),d=m(".enp-dash-item__quiz-id-b",n).val(),o=document.getElementById("enp-delete-ab-test-"+s+"a"+i+"b"+d),(u=new FormData(o)).append("enp-ab-test-submit","delete-ab-test"),u.append("action","save_ab_test"),t=u);var n,s,i,d,o,u;var r,c,l;return t}(t,n);m.ajax({type:"POST",url:quizDashboard.ajax_url,data:s,processData:!1,contentType:!1}).done(i).fail(function(e,a,t){console.log("AJAX failed",e.getAllResponseHeaders(),a,t)}).then(function(e,a,t){}).always(function(){o()})}),m("#enp-quiz").append('<section class="enp-quiz-message-ajax-container" aria-live="assertive"></section>')});