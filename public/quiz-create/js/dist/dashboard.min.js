jQuery(document).ready(function(l){function t(e){e.removeClass("enp-dash-item--menu-active"),l(".enp-dash-item__menu-action",e).attr("aria-expanded",!1).attr("aria-label","Open menu"),l(".enp-dash-item__nav",e).attr("aria-hidden",!0)}function n(e,a,t){if(void 0===t.responseJSON)return p(),_("Something went wrong. Please reload the page and try again.","error"),!1;var n=(e=t.responseJSON).message;if(n&&"object"==typeof n&&(void 0!==n.success&&0<n.success.length&&_(n.success[0],"success"),n.error)&&0<n.error.length)for(var s=0;s<n.error.length;s++)_(n.error[s],"error");var t=e.user_action.action,i=e.user_action.element;if("success"===e.status&&"update"===e.action&&"delete"===t){if("quiz"===i){if(dashItem=l("#enp-dash-item--"+e.quiz_id),!0===(e=>{var a,t=!1;for(a in e)if("secondary_action"===a)for(var n in e.secondary_action)if("ab_test_deleted"===n)return t=!0;return t})(e.user_action))for(var d,o,r,u=e.user_action.secondary_action.ab_test_deleted,c=0;c<u.length;c++)"delete"===u[c].user_action.action&&"success"===u[c].status&&(d=u[c].ab_test_id,o=u[c].quiz_id_a,r=u[c].quiz_id_b,m(l("#enp-dash-item--"+d+"a"+o+"b"+r)))}else"ab_test"===i&&(dashItem=l("#enp-dash-item--"+e.ab_test_id+"a"+e.quiz_id_a+"b"+e.quiz_id_b));m(dashItem)}}function m(e){e.addClass("enp-dash-item--remove"),setTimeout(function(){e.remove()},300)}function p(){l(".enp-quiz-submit").removeClass("enp-quiz-submit--wait")}function _(e,a){var t=Math.floor(1e3*Math.random()+1);l(".enp-quiz-message-ajax-container").append('<div class="enp-quiz-message enp-quiz-message--ajax enp-quiz-message--'+a+" enp-container enp-message-"+t+'"><p class="enp-message__list enp-message__list--'+a+'">'+e+"</p></div>"),l(".enp-message-"+t).delay(5e3).fadeOut(function(){l(this).remove()})}l(".enp-search-quizzes__button").addClass("enp-screen-reader-text"),l(document).on("change",".enp-search-quizzes__select",function(){l("#enp-search-quizzes").submit()}),l(".enp-dash-item__nav").each(function(){l(this).addClass("enp-dash-item__nav--collapsible").attr("aria-hidden",!0).before('<button class="enp-dash-item__menu-action" type="button" aria-expanded="false" aria-controls="'+l(this).attr("id")+'" aria-label="Open menu"><svg class="enp-dash-item__menu-action__icon enp-dash-item__menu-action__icon--bottom"><use xlink:href="#icon-chevron-down" /></svg></button>')}),l(document).on("click",".enp-dash-item__menu-action",function(){var e,a=l(this).closest(".enp-dash-item");a.hasClass("enp-dash-item--menu-active")?t(a):(0<(e=l(".enp-dash-item--menu-active")).length&&t(e),(e=a).addClass("enp-dash-item--menu-active"),l(".enp-dash-item__menu-action",e).attr("aria-expanded",!0).attr("aria-label","Close menu"),l(".enp-dash-item__nav",e).attr("aria-hidden",!1),l(".enp-dash-item__nav__item:eq(0) a",a).focus())}),l(".enp-dash-item__delete").click(function(e){e.preventDefault();var e=l(this).closest(".enp-dash-item"),a=l(this).val();if("delete-quiz"===a?confirmDeleteText="Are you sure you want to delete this quiz? This will also delete any AB Tests you have set-up with this Quiz.":"delete-ab-test"===a?confirmDeleteText="Are you sure you want to delete this AB Test?":alert("Something went wrong. Please send us an email telling us how you reached this error message"),!1===confirm(confirmDeleteText))return!1;if(l(this).hasClass("enp-quiz-submit--wait"))return!1;l(".enp-quiz-submit").addClass("enp-quiz-submit--wait"),(t=e).addClass("enp-dash-item--delete-wait"),t.append('<div class="spinner enp-dash-item__spinner"><div class="bounce bounce1"></div><div class="bounce bounce2"></div><div class="bounce bounce3"></div></div>');var t=((e,a)=>{var t;return"delete-quiz"===a?t=(e=>(e=l(".enp-dash-item__quiz-id",e).val(),e=document.getElementById("enp-delete-quiz-"+e),(e=new FormData(e)).append("enp-quiz-submit","delete-quiz"),e.append("action","save_quiz"),e))(e):"delete-ab-test"===a&&(t=(e=>{var a=l(".enp-dash-item__ab-test-id",e).val(),t=l(".enp-dash-item__quiz-id-a",e).val(),e=l(".enp-dash-item__quiz-id-b",e).val(),a=document.getElementById("enp-delete-ab-test-"+a+"a"+t+"b"+e);return(t=new FormData(a)).append("enp-ab-test-submit","delete-ab-test"),t.append("action","save_ab_test"),t})(e)),t})(e,a);l.ajax({type:"POST",url:quizDashboard.ajax_url,data:t,processData:!1,contentType:!1}).done(n).fail(function(e,a,t){console.log("AJAX failed",e.getAllResponseHeaders(),a,t)}).then(function(e,a,t){}).always(function(){p()})}),l("#enp-quiz").append('<section class="enp-quiz-message-ajax-container" aria-live="assertive"></section>')});