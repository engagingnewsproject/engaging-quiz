jQuery(document).ready(function(e){function n(n){n.addClass("enp-dash-item--menu-active"),e(".enp-dash-item__menu-action",n).attr("aria-expanded",!0),e(".enp-dash-item__nav",n).attr("aria-hidden",!1)}function t(n){n.removeClass("enp-dash-item--menu-active"),e(".enp-dash-item__menu-action",n).attr("aria-expanded",!1),e(".enp-dash-item__nav",n).attr("aria-hidden",!0)}function a(n,t,a){if(void 0===a.responseJSON)return m(),_("Something went wrong. Please reload the page and try again.","error"),!1;n=e.parseJSON(a.responseJSON),h(n.message);var s=n.user_action.action,i=n.user_action.element;if("success"===n.status&&"update"===n.action&&"delete"===s){if("quiz"===i){dashItem=e("#enp-dash-item--"+n.quiz_id);var o=r(n.user_action);o===!0&&c(n.user_action.secondary_action.ab_test_deleted)}else"ab_test"===i&&(dashItem=e("#enp-dash-item--"+n.ab_test_id+"a"+n.quiz_id_a+"b"+n.quiz_id_b));d(dashItem)}}function s(e,n){var t;return"delete-quiz"===n?t=i(e):"delete-ab-test"===n&&(t=o(e)),t}function i(n){var t=e(".enp-dash-item__quiz-id",n).val(),a=document.getElementById("enp-delete-quiz-"+t),s=new FormData(a);return s.append("enp-quiz-submit","delete-quiz"),s.append("action","save_quiz"),s}function o(n){var t=e(".enp-dash-item__ab-test-id",n).val(),a=e(".enp-dash-item__quiz-id-a",n).val(),s=e(".enp-dash-item__quiz-id-b",n).val(),i=document.getElementById("enp-delete-ab-test-"+t+"a"+a+"b"+s),o=new FormData(i);return o.append("enp-ab-test-submit","delete-ab-test"),o.append("action","save_ab_test"),o}function u(e){e.addClass("enp-dash-item--delete-wait"),e.append(l("enp-dash-item__spinner"))}function d(e){e.addClass("enp-dash-item--remove"),setTimeout(function(){e.remove()},300)}function r(e){var n=!1;for(var t in e)if("secondary_action"===t)for(var a in e.secondary_action)if("ab_test_deleted"===a)return n=!0;return n}function c(n){for(var t=0;t<n.length;t++)if("delete"===n[t].user_action.action&&"success"===n[t].status){var a=n[t].ab_test_id,s=n[t].quiz_id_a,i=n[t].quiz_id_b,o=e("#enp-dash-item--"+a+"a"+s+"b"+i);d(o)}}function l(e){return'<div class="spinner '+e+'"><div class="bounce bounce1"></div><div class="bounce bounce2"></div><div class="bounce bounce3"></div></div>'}function p(){e(".enp-quiz-submit").addClass("enp-quiz-submit--wait")}function m(){e(".enp-quiz-submit").removeClass("enp-quiz-submit--wait")}function _(n,t){var a=Math.floor(1e3*Math.random()+1);e(".enp-quiz-message-ajax-container").append('<div class="enp-quiz-message enp-quiz-message--ajax enp-quiz-message--'+t+" enp-container enp-message-"+a+'"><p class="enp-message__list enp-message__list--'+t+'">'+n+"</p></div>"),e(".enp-message-"+a).delay(3500).fadeOut(function(){e(".enp-message-"+a).fadeOut()})}function h(e){"undefined"!=typeof e.success&&e.success.length>0&&_(e.success[0],"success");for(var n=0;n<e.error.length;n++)_(e.error[n],"error")}e(".enp-search-quizzes__button").addClass("enp-screen-reader-text"),e(document).on("change",".enp-search-quizzes__select",function(){e("#enp-search-quizzes").submit()}),e(".enp-dash-item__nav").each(function(){e(this).addClass("enp-dash-item__nav--collapsible").attr("aria-hidden",!0).before('<button class="enp-dash-item__menu-action" type="button" aria-expanded="false" aria-controls="'+e(this).attr("id")+'"><svg class="enp-dash-item__menu-action__icon enp-dash-item__menu-action__icon--bottom"><use xlink:href="#icon-chevron-down" /></svg><svg class="enp-dash-item__menu-action__icon enp-dash-item__menu-action__icon--top"><use xlink:href="#icon-chevron-down" /></svg></button>')}),e(document).on("click",".enp-dash-item__menu-action",function(){var a=e(this).closest(".enp-dash-item");if(a.hasClass("enp-dash-item--menu-active"))t(a);else{var s=e(".enp-dash-item--menu-active");0<s.length&&t(s),n(a),e(".enp-dash-item__nav__item:eq(0) a",a).focus()}}),e(".enp-dash-item__delete").click(function(n){n.preventDefault();var t=e(this).closest(".enp-dash-item"),i=e(this).val();"delete-quiz"===i?confirmDeleteText="Are you sure you want to delete this quiz? This will also delete any AB Tests you have set-up with this Quiz.":"delete-ab-test"===i?confirmDeleteText="Are you sure you want to delete this AB Test?":alert("Something went wrong. Please send us an email telling us how you reached this error message");var o=confirm(confirmDeleteText);if(o===!1)return!1;if(e(this).hasClass("enp-quiz-submit--wait"))return!1;p(),u(t);var d=s(t,i);e.ajax({type:"POST",url:quizDashboard.ajax_url,data:d,processData:!1,contentType:!1}).done(a).fail(function(e,n,t){console.log("AJAX failed",e.getAllResponseHeaders(),n,t)}).then(function(e,n,t){}).always(function(){m()})}),e("#enp-quiz").append('<section class="enp-quiz-message-ajax-container" aria-live="assertive"></section>')});