#enp-quiz {
    // .enp-publish-page-container,
    // .enp-preview-page-container {
    //     @include container--wide;
    //     position: relative;
    //     @include xpadding-vertical;
    //     background: $really_light_gray;


    // }

    .enp-publish-page-container,
    .enp-quiz-form-container,
    .enp-preview-page-container {
        display: grid;
        grid-column: 2/-1;
        gap: 1rem;;
        width: 100%;
        justify-items: center;
        
        @include media(max-small) {
            padding-left: 8px;
            padding-right: 8px;
        }
        @include breakpoint(medium) {
            justify-items: start;
        }
    }
    // .enp-breadcrumb-link__container {
    //     display: grid;
    //     grid-column: 1/span 1;
    //     justify-content: center;
    //     align-items: flex-start;
    //     @include xpadding-vertical;
    // }
    .enp-quiz-form {
        display: grid;
        padding-left: 0;
        padding-right: 0;
        @include breakpoint(large) {
            width: 100%;
            max-width: 40rem;
        }
    }

    .enp-preview-page-flex-container {
        display: grid;
        gap: 1rem;

        @include breakpoint(medium) {
            grid-template-columns: 1fr 3fr;
            // padding: 0 2rem;
        }
    }

    .enp-quiz-title__label {
        @include label--bold;
    }

    .enp-quiz-title__textarea {
        @include input--xl;
    }
    
    textarea {
        color: #000;
    }

    .enp-accordion-container {
        margin-bottom: 1.6rem;
        position: relative;
    }

    .enp-question-content {
        @include accordion;
        padding-top: 0;
        position: relative;
    }

    .enp-question-inner {
        padding: 1.6rem 1.6rem 1rem;

        @include breakpoint(medium) {
            padding-right: 2.8rem;
            padding-left: 2.9rem;
        }

    }

    .enp-question-title__label {
        @include label--bold;
    }

    .enp-question-title__textarea {
        @include input--large;
    }

    .enp-question-image-upload {
        @include btn--dashed--light--alt-bg;
        @include small-uppercase;
        position: relative;
        margin-bottom: 2rem;
        transform: translate3d(0, 0, 0);
        transition: all .3s $fastInEaseOut;

        .enp-question-image-upload__icon--photo {
            @include icon--xxxl;
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            margin: 0 auto;
            transform: translate3d(0, 0, 0);
            z-index: -1;
            transition: opacity .2s, transform .3s $fastInEaseOut;
        }

        .enp-question-image-upload__icon--add {
            @include icon--circle--small;
            @include icon--gray-bg;
            margin-right: 5px;
            position: relative;
            top: 0.2rem;
        }

        &:hover,
        &:focus,
        &:active {
            padding-top: 5rem;
            padding-bottom: 2rem;

            .enp-question-image-upload__icon--photo {
                opacity: 1;
                z-index: 1;
                transform: translate3d(0, 1.75rem, 0);
            }

            .enp-question-image-upload__icon--add {
                @include icon--gray-bg--hover;
            }
        }
    }

    .enp-question-image__container {
        position: relative;
        margin-bottom: 1rem;
    }

    .enp-question-image {
        margin-bottom: 1.2rem;
    }

    @include radio-inline(enp-question-type);

    .enp-question-type__label {
        position: relative;
        z-index: 9;
    }

    .enp-slider-options,
    .enp-mc-options {
        margin-top: 0rem;
        display: none;
        animation: slideOutTop .25s $fastInEaseOut forwards;
        animation-delay: 0s, .05s;
    }

    .enp-question-type__input--slider:checked ~ .enp-slider-options,
    .enp-question-type__input--mc:checked ~ .enp-mc-options {
        visibility: visible;
        display: block;
        animation: fadeIn .45s $fastInEaseOut forwards;
    }

    .enp-mc-options__list {
        @include ul-no-style;
    }

    .enp-mc-option {
        position: relative;
        padding-left: 6px;
        &:nth-child(n + 2) {
            margin-top: 1.2rem;
        }
        @include breakpoint(medium) {
            padding-left: 0;
            
        }
    }

    .enp-mc-options__legend {
        @include legend--bold;
    }

    .enp-mc-option__add,
    .enp-mc-option__button--correct,
    .enp-mc-option__button--delete,
    .enp-mc-option__button--add-image,
    .enp-mc-option__right-actions {
        display: none;
    }

    .enp-question-type__input--mc:checked ~ .enp-mc-options {
        .enp-mc-option__add,
        .enp-mc-option__button--correct,
        .enp-mc-option__button--delete,
        .enp-mc-option__button--add-image {
            display: block;
        }
    }

    .enp-button__question-image-delete {
        @include btn--reset;
        position: absolute;
        top: 9px;
        right: -24px;
        fill: #bbb;
        cursor: pointer;

        @include breakpoint(medium) {
            right: -30px;
        }

        &:focus,
        &:hover {
            fill: $red;
        }
    }

    // MC option: stacked Add Image icon + Delete icon on the right of the input
    // Pin right-actions to top-right of input row so they stay in place when image/preview appears below
    .enp-mc-option__right-actions {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.25rem;

        .enp-mc-option__button--delete {
            position: static;
        }
    }

    .enp-mc-option__button--add-image,
    .enp-mc-option__right-actions .enp-mc-option__button--delete,
    .enp-mc-option-image-upload .enp-mc-option-image-preview__clear {
        @include btn--reset;
        fill: #bbb;
        cursor: pointer;
        padding: 0 0.25rem 0.25rem 0.25rem;

        .enp-icon {
            display: block;
            width: 20px;
            height: 20px;
        }

        &:focus,
        &:hover {
            fill: $red;
        }
    }
    .enp-mc-option-image-upload .enp-mc-option-image-preview__clear {
        padding: 0.25rem;
        fill: $red;
        &:focus,
        &:hover {
            fill: #bbb;
        }
    }
    .enp-mc-option__button--add-image {
        &:focus,
        &:hover {
            fill: $blue;
        }
    }

    .enp-mc-option__button--correct {
        @include btn--reset;
        position: absolute;
        top: 8px;
        left: -24px;

        @include breakpoint(medium) {
            left: -35px;
        }

        .enp-mc-option__icon--correct {
            @include icon--circle--pad;
            width: 28px;
            height: 28px;
            fill: #fff;
            background: #fff;
            cursor: pointer;
            border: 2px solid $fade_red;
            transition: all .2s;
        }

        &:focus .enp-mc-option__icon--correct,
        &:hover .enp-mc-option__icon--correct {
            background: #fff;
            border-color: $green;
            fill: $green;
        }

        &:disabled {
            opacity: 1;

            .enp-mc-option__icon--correct {
                cursor: default;
                fill: #fff;
                border: 2px solid transparent;
            }
        }
    }

    .enp-mc-option--correct {
        .enp-mc-option__input {
            box-shadow: inset 0 0 3px $blue;
            border: 1px solid $blue;
        }

        .enp-mc-option__button--correct:focus .enp-mc-option__icon--correct,
        .enp-mc-option__button--correct:hover .enp-mc-option__icon--correct,
        .enp-mc-option__icon--correct {
            fill: #fff;
            border-color: $blue;
            background: $blue;
        }
    }

    .enp-mc-option__add {
        @include btn--dashed--light--alt-bg;
        @include small-uppercase;
        text-align: left;
        padding: 0.7rem 0.75rem 0.8rem;

        .enp-mc-option__add__icon {
            @include btn--icon__icon--circle--small ;
            @include icon--gray-bg;
            position: relative;
            top: 0.2rem;
        }

        &:hover .enp-mc-option__add__icon {
            @include icon--gray-bg--hover;
        }
    }

    // MC option: row with text input; right-actions pinned so they don't move when preview appears
    .enp-mc-option__input-row {
        position: relative;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 0.25rem;

        .enp-mc-option__input {
            flex: 0 1 95%;
            min-width: 0;
            // Reserve space so text doesn't go under the right-action icons
        }
        .enp-mc-option__right-actions {
            flex: 1 0 5%;
        }
    }
    .enp-mc-option__input-row-content {
        display: flex;
        flex: 1 1 100%;
        order: 1;
    }
    // MC option image upload: container for link (and hidden file input); sits at end of input row.
    // Keep in document flow (no position: absolute) so when preview is visible it pushes content down.
    // max-width + min-width: 0 so flex item doesn't grow with huge image; image max-width: 100% then resolves correctly.
    .enp-mc-option-image-upload {
        min-width: 0;
        max-width: 100%;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        justify-content: flex-end;
        gap: 0.5rem;
        font-size: 14px;
        flex: 1 1 100%;
        order: 3;

        // Preview wraps to next line below the row; constrain so large images don't overflow
        .enp-mc-option-image-preview {
            width: 100%;
            min-width: 0;
            max-width: 100%;
        }
    }

    // MC option image upload: "Add Image" as a link at end of input
    .enp-mc-option-image-upload__trigger {
        color: $blue;
        text-decoration: none;
        font-size: inherit;
        cursor: pointer;
        background: none;
        border: 0;
        padding: 0;

        &:hover,
        &:focus {
            text-decoration: underline;
            color: darken($blue, 10%);
        }
    }

    // MC option image upload: hidden until option has 3+ characters (so option can be saved first)
    .enp-mc-option-image-upload--hidden-until-content {
        display: none;
    }

    // MC option image upload: hide native file input (link triggers it via JS)
    .enp-mc-option-image-upload .enp-mc-option-image-upload__input {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    // MC option image upload: preview hidden until file selected (JS removes --hidden)
    .enp-mc-option-image-preview--hidden {
        display: none;
    }

    // When preview is visible, add space below; position relative so clear button can sit bottom-right over image
    .enp-mc-option-image-preview {
        position: relative;
        margin-bottom: 1.6rem;
    }

    // Constrain preview image to container (large blob images can be very wide)
    .enp-mc-option-image-preview .enp-mc-option-image--preview {
        display: block;
        max-width: 100%;
        width: 100%;
        height: auto;
        margin-top: 0.4rem;
        object-fit: contain;
    }

    // Preview: clear/remove button (added by JS when file selected) â€” absolute bottom-right over image
    .enp-mc-option-image-preview__clear {
        @include btn--reset;
        position: absolute;
        bottom: 0.5rem;
        right: 0.5rem;
        padding: 0.4rem;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 4px;
        cursor: pointer;
        fill: #fff;
        transition: background 0.2s;

        &:hover,
        &:focus {
            background: rgba(0, 0, 0, 0.8);
        }

        .enp-icon {
            display: block;
            width: 20px;
            height: 20px;
        }
    }

    // Saved MC option image: container for image + delete overlay
    .enp-mc-option-image__container {
        position: relative;
        margin-bottom: 1rem;
    }

    // Saved MC option image: delete button absolute bottom-right over image
    .enp-mc-option-image__remove {
        @include btn--reset;
        position: absolute;
        bottom: 0.5rem;
        right: 0.5rem;
        padding: 0.4rem;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 4px;
        cursor: pointer;
        fill: #fff;
        transition: background 0.2s;

        &:hover,
        &:focus {
            background: rgba(0, 0, 0, 0.8);
        }

        .enp-icon {
            display: block;
            width: 20px;
            height: 20px;
        }
    }

    .enp-slider-options .enp-input {
        max-width: 11.8rem;
    }

    .enp-slider-range__container .enp-input,
    .enp-slider-correct__container .enp-input {
        max-width: 8.8rem;
        @include breakpoint('small') {
            max-width: 11.8rem;
        }
    }

    .enp-slider-preview {
        border: 1px solid #ddd;
        margin-top: 0.2rem;
        margin-bottom: 1.6rem;
        padding: 1.6rem 1.6rem .6rem;
        position: relative;

        .enp-label--slider-preview {
            position: absolute;
            width: 100%;
            top: 0.2rem;
            left: 0.4rem;
            font-size: 0.75rem;
            text-transform: uppercase;
        }
    }

    .enp-slider-range__container,
    .enp-slider-correct__container {
        @include flex-spread;
        align-items: center;
    }

    .enp-slider-range__helper,
    .enp-slider-correct__helper {
        color: #777;
        font-size: 0.85rem;
        background: #fff;
        padding: 0 .3rem;
        position: relative;

        &:before {
            content: '';
            position: absolute;
            top: 44%;
            height: 4px;
            background: #ddd;
            width: 120px;
            left: -60px;
            z-index: -1;
            transition: width 0.7s $fastInEaseOut, background 1.6s $fastInEaseOut;
        }
    }

    .enp-slider-options {
        margin-bottom: 2rem;

        .enp-accordion-header {
            text-transform: uppercase;
            font-size: 0.85rem;
            padding: 0.675rem;
        }

        .enp-slider-advanced-options__content {
            border: none;
            box-shadow: none;
            padding-top: 1rem;
            padding-bottom: 0;
            margin-bottom: 0;
        }
    }

    .enp-slider-correct-high__container {
        position: relative;
    }

    .enp-slider-correct-high__input-container--hidden {
        display: none;
    }

    .enp-slider-correct__helper--hidden {
        &:before {
            width: 0;
            background: $green;
        }
    }

    .enp-slider-correct-answer-range--add-range {
        @include btn--dashed--light--alt-bg;
        margin-left: 0.8rem;
        font-size: 0.7rem;

        @include breakpoint('small') {
            font-size: 0.8rem;
            padding: .7rem;
        }

        @include breakpoint('medium') {
            padding: .7rem 1.2rem;
            min-width: 11.4rem;
        }

        .enp-slider-correct-answer-range__icon {
            @include btn--icon__icon--circle--small ;
            @include icon--gray-bg;
            position: relative;
            left: -0.2rem;
        }

        &:hover .enp-slider-correct-answer-range__icon {
            @include icon--gray-bg--hover;
        }
    }

    .enp-slider-correct-answer-range--remove-range {
        position: absolute;
        right: -1.6rem;
        bottom: 1.6rem;
        background: none;
        border: none;
        box-shadow: none;
        padding: 0 0.1rem;

        .enp-slider-correct-answer-range__icon {
            width: 1.2em;
            height: 1.2em;
            fill: $dark_gray;
        }

        &:hover,
        &:focus {
            .enp-slider-correct-answer-range__icon {
                fill: $red;
            }
        }

        @include breakpoint(medium) {
            top: -0.2rem;
            right: -0.2rem;
            bottom: auto;
        }

    }

    .enp-slider-options .enp-input:read-only {
        background: $light_gray;
    }

    .enp-answer-explanation {
        background: $light_gray;
        padding-top: 2rem;
        box-shadow: inset 1px 0px 0 #ccc, inset -1px -1px 0 #ccc, inset 0 1px 0 #ddd;
    }

    .enp-answer-explanation__label {
        @include label--bold;

    }

    .enp-question__button--delete {
        @include btn--reset;
        position: absolute;
        top: 9px;
        right: 9px;
        fill: #bbb;
        cursor: pointer;

        @include breakpoint(medium) {
            right: -30px;
        }

        &:hover {
            fill: $red;
        }
    }

    .enp-question__move {
        position: absolute;
        left: 15px;

        @include breakpoint(medium) {
            left: -40px;
        }
    }

    .enp-sort__placeholder {
        background: #ddd;
        height: 60px;
        width: 100%;
        max-height: 120px;
        margin-bottom: 1.6rem;
    }

    .ui-sortable .ui-sortable-helper {
        .ui-sortable-handle {
            cursor: move;
            cursor: grabbing;
            cursor: -webkit-grabbing;
        }
    }
    

    .enp-question__button--move {
        @include btn--reset;
        position: absolute;
        fill: #bbb;
        cursor: pointer;

        &:hover, &:focus {
            fill: #333;
        }

        &:disabled {
            opacity: 0.5;
        }
    }

    .enp-question__button--move--up {
        top: -25px;
        left: -4px;
    }


    .enp-question__button--move--down {
        top: 3px;
        right: -20px;
    }

    .enp-quiz-form__add-question {
        @include btn--icon;
        @include btn--dashed;
        padding-top: 1rem;
        padding-bottom: 1rem;
        margin-top: 1.6rem;
        margin-bottom: 2rem;

        .enp-add-question__icon {
            @include btn--icon__icon--circle--small;
            @include icon--normal;
            @include icon--gray-bg;
            position: relative;
            top: 0.2rem;
        }

        &:hover .enp-add-question__icon {
            @include icon--gray-bg--hover;
        }
    }

    .enp-btn--save__btns {
        @include flex;
        align-items: center;
        align-items: flex-start;
    }

    .enp-quiz-form__save {
        @include btn;
        width: 100%;
        margin-bottom: 1rem;
        opacity: 0.8;
        text-shadow: 0px -1px 2px rgba(0,0,0,.6);

        &:hover,
        &:focus {
            opacity: 1;
        }

        @include breakpoint(small) {
            padding: 1.2rem 1.8rem 1.1rem;
            margin-right: 3%;
            position: relative;
        }
    }

    .enp-quiz-form__save--reveal {
        animation: slideInTop--reduced-opacity .3s $fastInEaseOut;
    }

    @include btn--icon--circle(enp-btn--next-step);

    .enp-btn--next-step {
        // @include btn;
        width: 100%;
        padding:  1rem 1.4rem 1rem;

        @include breakpoint(medium) {
            padding: 1.2rem 1.8rem 1.1rem;
        }
        .enp-btn--next-step__icon {
            width: 1rem;
            height: 1rem;
        }
        // @include breakpoint(small) {
        //     width: auto;
        // }

        /*
        * AFTER we have removed the Save button,
        * use this code to add the preview button into the
        * header
        @include media(max-medium) {
            padding:  1rem 1.4rem 1rem;
        }

        @include breakpoint(medium) {
            position: absolute;
            right: 20px;
            top: 10px;
            width: auto;
            z-index: 999999;

            &.enp-btn--next-step--fixed {
                position: fixed;
                animation: navSlideIn .25s;
            }
        }*/

    }

    .enp-btn--next-step--reveal {
        animation: slideInTop .3s $fastInEaseOut;
    }


    // UX interactions
    .enp-mc-option--inputs,
    .enp-accordion-header--inserting {
        animation: slideInBottom .4s $fastInEaseOut forwards;
    }

    .enp-mc-option--remove,
    .enp-question--remove,
    .enp-question__image--remove {
        animation: removeElement .5s $fastInEaseOut forwards;
    }

    .enp-image-upload-wait {
        @include btn--dashed--light--alt-bg;
        padding-top: 4rem;
        padding-bottom: 4rem;
        margin-bottom: 1rem;
        width: 100%;
    }

    // validation
    .enp-accordion-header.question-has-error {
        color: $red;
        box-shadow: 0 0 3px $red;
    }

    .enp-accordion-header__error {
        display: block;
        margin-top: 0.25rem;
        font-size: 0.875rem;
        font-weight: normal;
        color: $red;
    }
}

.enp-quiz.ui-sortable--sorting #enp-quiz .enp-accordion-content {
    display: none;
}